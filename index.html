<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>黄老桃李图</title>
    <style type="text/css">
        html {
            height: 100%
        }

        body {
            height: 100%;
            margin: 0px;
            padding: 0px
        }

        #container {
            height: 100%
        }
    </style>
    <script type="text/javascript" src="https://api.map.baidu.com/api?v=2.0&ak=m3t9CkUBWS7dGCiIAZgPNDEmCiOVh3S2">
        //v2.0版本的引用方式：src="http://api.map.baidu.com/api?v=2.0&ak=您的密钥"
//v1.4版本及以前版本的引用方式：src="http://api.map.baidu.com/api?v=1.4&key=您的密钥&callback=initialize"
    </script>
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-102189154-1', 'auto');
        ga('send', 'pageview');
    </script>
</head>

<body>
    <div id="container"></div>
    <script type="text/javascript">
        var map = new BMap.Map("container");          // 创建地图实例
        map.centerAndZoom('成都市', 7);
        var geo = new BMap.Geocoder();

        var students = [
            {
                "序号": 1,
                "姓名": "蒋大成",
                "手机号": 15501517122,
                "状态": "博士在读",
                "常驻地": "N.A.",
                "工作/学习单位": "N.A."
            },
            {
                "序号": 2,
                "姓名": "杨世超",
                "手机号": 18508199666,
                "状态": "工作",
                "常驻地": "N.A.",
                "工作/学习单位": "N.A."
            },
            {
                "序号": 3,
                "姓名": "陈懋斐",
                "手机号": 15811168129,
                "状态": "博士在读",
                "常驻地": "北京",
                "工作/学习单位": "清华大学"
            },
            {
                "序号": 4,
                "姓名": "邓星",
                "手机号": 18311315280,
                "状态": "工作",
                "常驻地": "北京",
                "工作/学习单位": 360
            },
            {
                "序号": 5,
                "姓名": "黄珊",
                "手机号": 15201521397,
                "状态": "博士在读",
                "常驻地": "北京",
                "工作/学习单位": "清华"
            },
            {
                "序号": 6,
                "姓名": "廖威",
                "手机号": 18211062963,
                "状态": "工作",
                "常驻地": "北京",
                "工作/学习单位": "默沙东（中国）投资有限公司"
            },
            {
                "序号": 7,
                "姓名": "刘晓玉",
                "手机号": 13126577360,
                "状态": "工作",
                "常驻地": "北京",
                "工作/学习单位": "N.A."
            },
            {
                "序号": 8,
                "姓名": "陈忠逸",
                "手机号": 13568337782,
                "状态": "工作",
                "常驻地": "成都",
                "工作/学习单位": "市建委"
            },
            {
                "序号": 9,
                "姓名": "冯栩铭",
                "手机号": 18801954108,
                "状态": "工作",
                "常驻地": "成都",
                "工作/学习单位": "N.A."
            },
            {
                "序号": 10,
                "姓名": "郭丽鹃",
                "手机号": 18780264984,
                "状态": "工作",
                "常驻地": "成都",
                "工作/学习单位": "中投证券"
            },
            {
                "序号": 11,
                "姓名": "黎志",
                "手机号": 18011436887,
                "状态": "工作",
                "常驻地": "成都",
                "工作/学习单位": "四川多元律师事务所"
            },
            {
                "序号": 12,
                "姓名": "李安琪",
                "手机号": 18215588395,
                "状态": "硕士在读",
                "常驻地": "成都",
                "工作/学习单位": "N.A."
            },
            {
                "序号": 13,
                "姓名": "李红燕",
                "手机号": 18769783365,
                "状态": "工作",
                "常驻地": "成都",
                "工作/学习单位": "银行"
            },
            {
                "序号": 14,
                "姓名": "刘晓亚",
                "手机号": "18883703632（即将换）",
                "状态": "工作",
                "常驻地": "成都",
                "工作/学习单位": "中电29所"
            },
            {
                "序号": 15,
                "姓名": "唐洁",
                "手机号": 18608161647,
                "状态": "工作",
                "常驻地": "成都",
                "工作/学习单位": "太平人寿"
            },
            {
                "序号": 16,
                "姓名": "邬聪",
                "手机号": 18081221929,
                "状态": "工作",
                "常驻地": "成都",
                "工作/学习单位": "空管"
            },
            {
                "序号": 17,
                "姓名": "武建霖",
                "手机号": 17709000560,
                "状态": "工作",
                "常驻地": "成都",
                "工作/学习单位": "部队"
            },
            {
                "序号": 18,
                "姓名": "向阳",
                "手机号": 18116267807,
                "状态": "工作",
                "常驻地": "成都",
                "工作/学习单位": "远东租赁"
            },
            {
                "序号": 19,
                "姓名": "杨朝凯",
                "手机号": 13551069168,
                "状态": "工作",
                "常驻地": "成都",
                "工作/学习单位": "四川航空"
            },
            {
                "序号": 20,
                "姓名": "叶恬",
                "手机号": 18502896030,
                "状态": "工作",
                "常驻地": "成都",
                "工作/学习单位": "广发银行"
            },
            {
                "序号": 21,
                "姓名": "向凌威",
                "手机号": 18810245416,
                "状态": "其它",
                "常驻地": "成都/北京",
                "工作/学习单位": "国家空间科学中心"
            },
            {
                "序号": 22,
                "姓名": "陈俊霖",
                "手机号": 18782944509,
                "状态": "工作",
                "常驻地": "广州",
                "工作/学习单位": "中铁二局"
            },
            {
                "序号": 23,
                "姓名": "赵小夫",
                "手机号": 18580016268,
                "状态": "工作",
                "常驻地": "韩城/苏州",
                "工作/学习单位": "中车建设工程有限公司"
            },
            {
                "序号": 24,
                "姓名": "张志强",
                "手机号": 18089092419,
                "状态": "工作",
                "常驻地": "拉萨",
                "工作/学习单位": "N.A."
            },
            {
                "序号": 25,
                "姓名": "蹇雄",
                "手机号": 18909082022,
                "状态": "工作",
                "常驻地": "泸州",
                "工作/学习单位": 31678
            },
            {
                "序号": 26,
                "姓名": "谢婕",
                "手机号": 18716106730,
                "状态": "工作",
                "常驻地": "泸州",
                "工作/学习单位": "江阳区地税"
            },
            {
                "序号": 27,
                "姓名": "刘杨",
                "手机号": 15181607680,
                "状态": "工作",
                "常驻地": "绵阳",
                "工作/学习单位": "建行"
            },
            {
                "序号": 28,
                "姓名": "周小清",
                "手机号": 18281466028,
                "状态": "工作",
                "常驻地": "绵阳",
                "工作/学习单位": "绵阳市中心医院"
            },
            {
                "序号": 29,
                "姓名": "兰红",
                "手机号": 13258409445,
                "状态": "工作",
                "常驻地": "南充",
                "工作/学习单位": "南充市中心医院"
            },
            {
                "序号": 30,
                "姓名": "王玲",
                "手机号": 13658073139,
                "状态": "工作",
                "常驻地": "南充",
                "工作/学习单位": "N.A."
            },
            {
                "序号": 31,
                "姓名": "段磊",
                "手机号": 15365138904,
                "状态": "工作",
                "常驻地": "南京",
                "工作/学习单位": "碧桂园"
            },
            {
                "序号": 32,
                "姓名": "墨丁",
                "手机号": 15762251602,
                "状态": "工作",
                "常驻地": "青岛",
                "工作/学习单位": "普华永道"
            },
            {
                "序号": 33,
                "姓名": "税小丽",
                "手机号": 8060002993,
                "状态": "工作",
                "常驻地": "日本横滨",
                "工作/学习单位": "株式会社IHI"
            },
            {
                "序号": 34,
                "姓名": "漆绍洋",
                "手机号": 15351247718,
                "状态": "工作",
                "常驻地": "上海",
                "工作/学习单位": "饿了么"
            },
            {
                "序号": 35,
                "姓名": "王燕",
                "手机号": 15900801618,
                "状态": "工作",
                "常驻地": "上海",
                "工作/学习单位": "光大证券资产管理有限公司"
            },
            {
                "序号": 36,
                "姓名": "吴欣芝",
                "手机号": 15618720013,
                "状态": "工作",
                "常驻地": "上海",
                "工作/学习单位": "太平资产管理"
            },
            {
                "序号": 37,
                "姓名": "杨佳洁",
                "手机号": 18616345261,
                "状态": "工作",
                "常驻地": "上海",
                "工作/学习单位": "N.A."
            },
            {
                "序号": 38,
                "姓名": "赵川锐",
                "手机号": 18817559293,
                "状态": "硕士在读",
                "常驻地": "上海",
                "工作/学习单位": "上海交大"
            },
            {
                "序号": 39,
                "姓名": "胡超",
                "手机号": 18268079646,
                "状态": "工作",
                "常驻地": "深圳",
                "工作/学习单位": "华润"
            },
            {
                "序号": 40,
                "姓名": "李雪",
                "手机号": 15811422910,
                "状态": "工作",
                "常驻地": "深圳",
                "工作/学习单位": "ZNV"
            },
            {
                "序号": 41,
                "姓名": "李颖",
                "手机号": 13510593201,
                "状态": "工作",
                "常驻地": "深圳",
                "工作/学习单位": "北京银行"
            },
            {
                "序号": 42,
                "姓名": "李勇强",
                "手机号": 15681168269,
                "状态": "工作",
                "常驻地": "深圳",
                "工作/学习单位": "N.A."
            },
            {
                "序号": 43,
                "姓名": "唐瀿溟",
                "手机号": 18923480797,
                "状态": "工作",
                "常驻地": "深圳",
                "工作/学习单位": "华为"
            },
            {
                "序号": 44,
                "姓名": "王灿",
                "手机号": 13689066926,
                "状态": "工作",
                "常驻地": "深圳",
                "工作/学习单位": "华为技术有限公司"
            },
            {
                "序号": 45,
                "姓名": "张伟",
                "手机号": 18725732771,
                "状态": "工作",
                "常驻地": "深圳",
                "工作/学习单位": "华阳国际工程设计股份有限公司"
            },
            {
                "序号": 46,
                "姓名": "赵森棽",
                "手机号": 18622025074,
                "状态": "工作",
                "常驻地": "天津",
                "工作/学习单位": "天津广播电视台"
            },
            {
                "序号": 47,
                "姓名": "安丰汉",
                "手机号": 18920821875,
                "状态": "工作",
                "常驻地": "天津/杭州",
                "工作/学习单位": "华信咨询设计研究院有限公司"
            },
            {
                "序号": 48,
                "姓名": "聂凯",
                "手机号": 13163362976,
                "状态": "博士在读",
                "常驻地": "武汉",
                "工作/学习单位": "武汉大学土建学院工程力学系"
            },
            {
                "序号": 49,
                "姓名": "封明仁",
                "手机号": 18508272577,
                "状态": "工作",
                "常驻地": "西安",
                "工作/学习单位": "N.A."
            },
            {
                "序号": 50,
                "姓名": "孙潇雨",
                "手机号": "18908325254（即将换）",
                "状态": "博士在读",
                "常驻地": "香港",
                "工作/学习单位": "N.A."
            },
            {
                "序号": 51,
                "姓名": "何锋",
                "手机号": 18789494198,
                "状态": "工作",
                "常驻地": "云南红河",
                "工作/学习单位": "N.A."
            },
            {
                "序号": 52,
                "姓名": "白玲",
                "手机号": 18744016551,
                "状态": "硕士在读",
                "常驻地": "长春",
                "工作/学习单位": "吉林大学第一医院肿瘤中心"
            },
            {
                "序号": 53,
                "姓名": "龚栎鉴",
                "手机号": 18716425859,
                "状态": "工作",
                "常驻地": "重庆",
                "工作/学习单位": "中海地产集团有限公司（西部区）"
            },
            {
                "序号": 54,
                "姓名": "邱成",
                "手机号": 15881422138,
                "状态": "工作",
                "常驻地": "重庆",
                "工作/学习单位": "N.A."
            },
            {
                "序号": 55,
                "姓名": "詹政阳",
                "手机号": 13220205758,
                "状态": "工作",
                "常驻地": "重庆",
                "工作/学习单位": "碧桂园集团"
            },
            {
                "序号": 56,
                "姓名": "刘源",
                "手机号": 15736098964,
                "状态": "工作",
                "常驻地": "重庆/成都",
                "工作/学习单位": "四川航空"
            }
        ];
        var defaultPoint = new BMap.Point(104.705518975, 31.5047012581);

        var marker = new BMap.Marker(defaultPoint);
        students.forEach(function (student) {
            if (student["常驻地"] == '成都') console.log(student['姓名']);
            geo.getPoint(student["常驻地"], function (point) {
                if (point) {
                    point = addRandom(point);
                    marker = new BMap.Marker(point);
                    map.addOverlay(marker);
                } else {
                    marker = new BMap.Marker(defaultPoint);
                }
                var infoWindow = new BMap.InfoWindow(show(student));  // 创建信息窗口对象
                marker.addEventListener("click", function () {
                    this.openInfoWindow(infoWindow);
                    //图片加载完毕重绘infowindow
                    document.getElementById('imgDemo').onload = function () {
                        infoWindow.redraw();   //防止在网速较慢，图片未加载时，生成的信息框高度比图片的总高度小，导致图片部分被隐藏
                    }
                });
            })
        });



        map.addControl(new BMap.NavigationControl());

        function addRandom(point) {
            point.lng += Math.random() * 0.1;
            point.lat += Math.random() * 0.1;
            return point;
        }
        function show(student) {
            var sContent =
                `<table>
                            <tr>
                                <td>姓名：${student['姓名']}</td>
                            </tr>
                            <tr>
                                <td>手机：${student["手机号"]}</td>
                            </tr>
                            <tr>
                                <td>状态：${student["状态"]}</td>
                            </tr>
                             <tr>
                                <td>单位：${student["工作/学习单位"]}</td>
                            </tr>
                        </table>
                        <img  id='imgDemo' 
                            style="width: 50%; height: 50%"
                         src='http://img5.mtime.cn/ph/2016/11/14/111046.75660912_290X440X4.jpg' 
                         />`;
            return sContent;
        }
    </script>
</body>

</html>